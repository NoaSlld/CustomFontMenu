<li onclick="toggleChildren(this)">
    <div class="item {if $item.depth == 0}zero-depth{elseif $item.depth % 2 == 0}even-depth{/if}">
        <a class="drag-and-drop-icon"><i class="fas fa-bars"></i></a>
        <div class="title-container">
            <span data-id="titleSpan" onclick="toggleChildren(this)">{$item.title}</span>
        </div>
        <div class="btn-group">
            <a title="Edit this item" href="" class="btn btn-info btn-responsive">
                <i class="glyphicon glyphicon-edit"></i>
            </a>
            <a title="Add a new child" class="btn btn-primary btn-responsive action-btn" data-toggle="modal">
                <i class="glyphicon glyphicon-plus-sign"></i>
            </a>
            <a title="Delete this item" href="#" class="btn btn-danger btn-responsive module-delete-action" data-toggle="modal">
                <i class="glyphicon glyphicon-trash"></i>
            </a>
        </div>
        <span class="arrows">
            <a class="leftArrow"><i class="fas fa-chevron-up menu-collapse"></i></a>
            <a class="rightArrow"><i class="fas fa-chevron-down menu-collapse"></i></a>
        </span>
    </div>
    {if isset($item.children) && $item.children}
        <ul class="menu-item depth-{$item.depth + 1}">
            {foreach $item.children as $child}
                {include file="menu-item.html" item=$child}
            {/foreach}
        </ul>
    {else}
        <ul class="menu-item-{$item.depth + 1}" style="display: none;"></ul>
    {/if}
</li>

<script>
    function toggleChildren(span) {
        // Récupérer l'élément parent <li>
        const listItem = span.closest('li');

        // Récupérer les enfants de l'élément parent <li>
        const childrenUl = listItem.querySelector('ul');

        // Si l'élément parent <li> a des enfants
        if (childrenUl) {
            // Si les enfants sont visibles, les masquer; sinon, les afficher
            childrenUl.style.display = childrenUl.style.display === 'none' ? 'block' : 'none';
        }

        // Masquer tous les enfants directs des autres éléments de menu
        const allMenuItems = listItem.parentElement.querySelectorAll('li');
        allMenuItems.forEach(function(menuItem) {
            // Si l'élément cliqué est un parent de menuItem mais pas lui-même
            if (listItem.contains(menuItem) && menuItem !== listItem && menuItem.querySelector('ul')) {
                menuItem.querySelector('ul').style.display = 'none';
            }
        });

        // Empêcher la propagation de l'événement
        event.stopPropagation();
    }




    document.addEventListener('click', function(event) {
        const clickedElement = event.target;
        // Vérifier si l'élément cliqué est un élément enfant
        if (clickedElement.closest('.menu-item') && !clickedElement.closest('.clicked')) {
            // Masquer tous les enfants de tous les éléments de menu
            const allMenuItems = document.querySelectorAll('.menu-item > li');
            allMenuItems.forEach(function(menuItem) {
                const childrenUl = menuItem.querySelector('ul');
                if (childrenUl) {
                    childrenUl.style.display = 'none';
                }
            });
        }
    });


</script>